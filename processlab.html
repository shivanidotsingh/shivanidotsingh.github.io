<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>making of the sausage</title>
<meta name="description" content="artefacts from work - out of context." />
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='86'>âœ§</text></svg>">

<style>
  :root{
    --bg: #fff;
    --fg: #111;
    --accent: #0a84ff;

    --peek-gap: 60px;      /* horizontal gap between items */
    --base-shift: 380px;   /* how far each neighbor sits from center */
    --center-max-w: 80vw;
    --center-max-h: 72vh;
    --side-scale-1: .78;   /* scale for immediate neighbors */
    --side-scale-2: .62;   /* next neighbors */
    --side-scale-3: .50;   /* further neighbors */
  }

  * { box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    margin: 0; background: var(--bg); color: var(--fg);
    font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, sans-serif;
  }

  .wrap {
    position: fixed; inset: 0;
    display: grid; grid-template-rows: auto 1fr; /* header + stage */
  }

  header { padding: 14px 18px; color: #777; letter-spacing: .25px; }

  /* Stage with perspective for subtle depth */
  .stage {
    position: relative;
    overflow: hidden;
    perspective: 1600px;
    background: #fff;
  }

  /* Track holds all items centered */
  .track {
    position: absolute; inset: 0;
    transform-style: preserve-3d;
    will-change: transform;
  }

  /* Each gallery item is absolutely positioned and transformed by JS */
  .item {
    position: absolute; top: 50%; left: 50%;
    transform-origin: center center;
    transition: transform .35s cubic-bezier(.2,.6,0,1), opacity .35s ease;
    user-select: none;
  }

  /* The card that constrains the image size */
  .card {
    display: grid; place-items: center;
    background: #fff;
    border: 1px solid #eee;
    border-radius: 10px;
    box-shadow: 0 15px 40px rgba(0,0,0,.08);
    overflow: hidden;
    max-width: var(--center-max-w);
    max-height: var(--center-max-h);
  }
  .card img {
    display: block; width: 100%; height: 100%;
    object-fit: contain; background: #fff;
  }

  .item.side { opacity: .8; filter: saturate(.95); }
  .item.far  { opacity: .5; filter: saturate(.85) blur(.2px); }
  .item.hidden { opacity: 0; pointer-events: none; }

  /* Side nav buttons */
  .nav-btn {
    position: absolute; top: 50%; transform: translateY(-50%);
    display: grid; place-items: center;
    width: 42px; height: 42px; border-radius: 50%;
    background: rgba(255,255,255,.9);
    border: 1px solid #e6e6e6;
    box-shadow: 0 6px 20px rgba(0,0,0,.07);
    cursor: pointer; user-select: none;
    transition: transform .08s ease, border-color .2s ease, background .2s ease;
  }
  .nav-btn:hover { border-color: #d0d0d0; background: rgba(255,255,255,1); }
  .nav-btn:active { transform: translateY(-50%) scale(.98); }
  .nav-left  { left: 14px; }
  .nav-right { right: 14px; }
  .nav-btn svg { width: 18px; height: 18px; }

  @media (max-width: 900px){
    :root{
      --base-shift: 280px;
      --peek-gap: 40px;
      --center-max-h: 64vh;
    }
    .nav-btn { width: 38px; height: 38px; }
  }
</style>
</head>

<body>
  <div class="wrap">
    <header>making of the sausage</header>

    <main class="stage" id="stage">
      <div class="track" id="track"></div>

      <!-- side nav -->
      <button class="nav-btn nav-left" id="prev" aria-label="Previous">
        <svg viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke="#111" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
      <button class="nav-btn nav-right" id="next" aria-label="Next">
        <svg viewBox="0 0 24 24" fill="none"><path d="M9 6l6 6-6 6" stroke="#111" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
    </main>
  </div>

  <script>
    /* Your images (spaces supported) */
    const IMAGES = [
      "images/process/ADT vision.png",
      "images/process/Concentric.png",
      "images/process/criteriaforintake.png",
      "images/process/CRM.png",
      "images/process/cryptotransfer.png",
      "images/process/curriculum.png",
      "images/process/Datapoints.png",
      "images/process/GNC learning.png",
      "images/process/humaneval.png",
      "images/process/knowledge sharing.png",
      "images/process/Laddering Data.jpg",
      "images/process/manual.png",
      "images/process/medium is msg.png",
      "images/process/Name Parameters.png",
      "images/process/naming systems.png",
      "images/process/ORG.png",
      "images/process/ourresources.png",
      "images/process/opp.png",
      "images/process/Persona.jpg",
      "images/process/playground UI.png",
      "images/process/Product Partnerships Data Knowledge.png",
      "images/process/Reach.png",
      "images/process/Reachout if.png",
      "images/process/Rules.png",
      "images/process/scales of a problem.png",
      "images/process/timeline.png",
      "images/process/types of slides.png",
      "images/process/vendorgrid.png",
      "images/process/whatwedonose.png",
      "images/process/why-how.png",
      "images/process/XCapit.png"
    ];

    const stageEl = document.getElementById('stage');
    const track   = document.getElementById('track');
    const nextBtn = document.getElementById('next');
    const prevBtn = document.getElementById('prev');

    const CTRL = {
      baseShift: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--base-shift')) || 380,
      peekGap:   parseInt(getComputedStyle(document.documentElement).getPropertyValue('--peek-gap'))   || 60,
      scale: [1,
              parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--side-scale-1')) || .78,
              parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--side-scale-2')) || .62,
              parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--side-scale-3')) || .50],
    };

    // Start at a RANDOM image each load
    let current = Math.floor(Math.random() * IMAGES.length);
    const cards = [];

    function createItem(src, i){
      const item = document.createElement('figure');
      item.className = 'item';
      item.dataset.i = i;

      const card = document.createElement('div');
      card.className = 'card';

      const img = document.createElement('img');
      img.alt = `image ${i+1}`;
      img.loading = 'lazy';
      img.decoding = 'async';
      img.src = encodeURI(src);
      card.appendChild(img);
      item.appendChild(card);

      // click a side card to focus it
      item.addEventListener('click', () => {
        const idx = +item.dataset.i;
        if (idx !== current) goTo(idx);
      });

      track.appendChild(item);
      cards.push(item);
    }

    // Position items based on current index
    function render(){
      const { baseShift, peekGap, scale } = CTRL;

      cards.forEach((item, i) => {
        const d  = i - current;   // distance from center in items
        const ad = Math.abs(d);   // absolute distance
        let s = 1, x = 0, rY = 0, z = 0, cls = '';

        if (ad === 0){
          s = 1; x = 0; rY = 0; z = 0; cls = '';
        } else if (ad === 1){
          s = scale[1]; x = Math.sign(d) * (baseShift + peekGap * 0.0); rY = -Math.sign(d) * 12; z = -80; cls = 'side';
        } else if (ad === 2){
          s = scale[2]; x = Math.sign(d) * (baseShift*2 + peekGap * 0.5); rY = -Math.sign(d) * 16; z = -160; cls = 'far';
        } else {
          s = scale[3]; x = Math.sign(d) * (baseShift*2.7 + (ad-2)*90); rY = -Math.sign(d) * 18; z = -260; cls = 'hidden';
        }

        item.className = `item ${cls}`.trim();
        // Center is already top:50%/left:50% with translate(-50%,-50%). Only offset by x.
        item.style.transform =
          `translate3d(${x}px, 0px, ${z}px) translate(-50%, -50%) rotateY(${rY}deg) scale(${s})`;
      });
    }

    function goTo(i){
      current = Math.max(0, Math.min(cards.length - 1, i));
      render();
    }

    function next(){ if (current < cards.length - 1) goTo(current + 1); }
    function prev(){ if (current > 0) goTo(current - 1); }

    // Input: buttons, keys, wheel, drag/swipe
    nextBtn.addEventListener('click', next);
    prevBtn.addEventListener('click', prev);

    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') next();
      if (e.key === 'ArrowLeft')  prev();
    });

    // Wheel: horizontal nav (bind to STAGE)
    let wheelLock = false;
    stageEl.addEventListener('wheel', (e) => {
      if (wheelLock) return;
      wheelLock = true;
      setTimeout(()=>wheelLock=false, 180);
      const delta = Math.abs(e.deltaX) > Math.abs(e.deltaY) ? e.deltaX : e.deltaY;
      if (delta > 0) next(); else if (delta < 0) prev();
    }, { passive: true });

    // Drag / swipe (bind to STAGE)
    (function dragNav(){
      let down = false, sx = 0, moved = 0;
      stageEl.addEventListener('pointerdown', (e) => { down = true; sx = e.clientX; moved = 0; });
      stageEl.addEventListener('pointermove', (e) => {
        if (!down) return;
        moved = e.clientX - sx;
        // live-peek while dragging (subtle)
        const shift = moved / (CTRL.baseShift * 1.25);
        const tempIndex = current - shift;
        const prevCurrent = current;
        current = Math.min(cards.length-1, Math.max(0, tempIndex));
        render();
        current = prevCurrent;
      });
      const release = () => {
        if (!down) return; down = false;
        const threshold = 60;
        if (moved < -threshold) next();
        else if (moved > threshold) prev();
        else render(); // snap back
      };
      stageEl.addEventListener('pointerup', release);
      stageEl.addEventListener('pointercancel', () => { down = false; render(); });
      stageEl.addEventListener('mouseleave', () => { down = false; });
    })();

    // Build
    IMAGES.forEach((src, i) => createItem(src, i));

    // Re-render on stage resize
    const ro = new ResizeObserver(render);
    ro.observe(stageEl);
    window.addEventListener('resize', render);

    // Initial render at a random index
    render();
  </script>
</body>
</html>
