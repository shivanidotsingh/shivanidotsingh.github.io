<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>making of the sausage</title>
<meta name="description" content="artefacts from work - out of context" />
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='86'>✧</text></svg>">

<style>
  :root{
    --bg:#fff; --fg:#111;

    /* desktop gallery tuning (same feel as the working version) */
    --peek-gap:60px;
    --base-shift:380px;
    --center-max-w:80vw;
    --center-max-h:72vh;
    --side-scale-1:.78;
    --side-scale-2:.62;
    --side-scale-3:.50;

    --nav-size:44px;
    --nav-edge:14px;
  }

  *{ box-sizing:border-box }
  html,body{ height:100% }
  body{
    margin:0; background:var(--bg); color:var(--fg);
    font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
    -webkit-text-size-adjust:100%;
  }

  /* ===== Desktop wrapper (hidden on touch devices) ===== */
  .wrap{ position:fixed; inset:0; display:grid; grid-template-rows:auto 1fr }
  header{
    padding:14px max(18px, env(safe-area-inset-left)) 10px max(18px, env(safe-area-inset-right));
    color:#777; letter-spacing:.25px;
  }

  /* Stage */
  .stage{
    position:relative;
    overflow:hidden;
    perspective:1600px;
    background:#fff;
    touch-action:pan-y;
    -webkit-user-select:none; user-select:none;
    -webkit-tap-highlight-color:transparent;
  }
  .track{ position:absolute; inset:0; transform-style:preserve-3d; will-change:transform; }

  /* Items: baseline centered; JS nudges horizontally only */
  .item{
    position:absolute; top:50%; left:50%;
    transform-origin:center center;
    transition:transform .35s cubic-bezier(.2,.6,0,1), opacity .35s ease;
    user-select:none;
  }

  /* Card: clean edges (no radius/shadow/border) */
  .card{
    display:grid; place-items:center;
    background:#fff;
    max-width:var(--center-max-w);
    max-height:var(--center-max-h);
  }
  .card img{
    display:block; width:100%; height:100%; object-fit:contain;
    -webkit-user-drag:none; user-drag:none; pointer-events:none;
  }

  .item.side { opacity:.8;  filter:saturate(.95); }
  .item.far  { opacity:.5;  filter:saturate(.85) blur(.2px); }
  .item.hidden { opacity:0; pointer-events:none; }

  /* Side nav buttons */
  .nav-btn{
    position:absolute; top:50%; transform:translateY(-50%);
    display:grid; place-items:center;
    width:var(--nav-size); height:var(--nav-size); border-radius:50%;
    background:rgba(255,255,255,.98); border:1px solid #e6e6e6;
    box-shadow:0 6px 20px rgba(0,0,0,.07);
    cursor:pointer; user-select:none;
    transition:transform .08s ease, border-color .2s ease, background .2s ease;
    z-index:2;
  }
  .nav-btn:hover { border-color:#d0d0d0; background:#fff; }
  .nav-btn:active { transform:translateY(-50%) scale(.98); }
  .nav-left  { left: calc(var(--nav-edge) + env(safe-area-inset-left)); }
  .nav-right { right:calc(var(--nav-edge) + env(safe-area-inset-right)); }
  .nav-btn svg{ width:18px; height:18px; }

  /* ===== Mobile/tablet banner (show only on touch devices) ===== */
  .mobile-only{
    display:none;
    position:fixed; inset:0; display:none;
    place-items:center; text-align:center; padding:24px;
    background:#fff; color:#111;
  }
  @media (hover:none) and (pointer:coarse){
    .wrap{ display:none; }         /* hide gallery */
    .mobile-only{ display:grid; }  /* show message */
  }
</style>
</head>

<body>
  <!-- Desktop-only gallery -->
  <div class="wrap">
    <header>screenshots from the desktop, out of context</header>

    <main class="stage" id="stage">
      <div class="track" id="track"></div>

      <button class="nav-btn nav-left" id="prev" type="button" aria-label="Previous">
        <svg viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke="#111" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
      <button class="nav-btn nav-right" id="next" type="button" aria-label="Next">
        <svg viewBox="0 0 24 24" fill="none"><path d="M9 6l6 6-6 6" stroke="#111" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
    </main>
  </div>

  <!-- Touch devices: show only this -->
  <div class="mobile-only">view on desktop</div>

  <script>
    /* === Original working gallery logic (desktop only) === */
    const IMAGES = [
      "images/process/ADT vision.png",
      "images/process/Concentric.png",
      "images/process/criteriaforintake.png",
      "images/process/CRM.png",
      "images/process/cryptotransfer.png",
      "images/process/curriculum.png",
      "images/process/Datapoints.png",
      "images/process/GNC learning.png",
      "images/process/humaneval.png",
      "images/process/knowledge sharing.png",
      "images/process/Laddering Data.jpg",
      "images/process/manual.png",
      "images/process/medium is msg.png",
      "images/process/Name Parameters.png",
      "images/process/naming systems.png",
      "images/process/ORG.png",
      "images/process/ourresources.png",
      "images/process/opp.png",
      "images/process/Persona.jpg",
      "images/process/playground UI.png",
      "images/process/Product Partnerships Data Knowledge.png",
      "images/process/Reach.png",
      "images/process/Reachout if.png",
      "images/process/Rules.png",
      "images/process/scales of a problem.png",
      "images/process/timeline.png",
      "images/process/types of slides.png",
      "images/process/vendorgrid.png",
      "images/process/whatwedonose.png",
      "images/process/XCapit.png"
    ];

    // If on touch device, don't boot the gallery (CSS already hides it)
    const isTouch = matchMedia("(hover: none) and (pointer: coarse)").matches;
    if (!isTouch) {
      const stageEl = document.getElementById('stage');
      const track   = document.getElementById('track');
      const nextBtn = document.getElementById('next');
      const prevBtn = document.getElementById('prev');

      const CTRL = {
        baseShift: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--base-shift')) || 380,
        peekGap:   parseInt(getComputedStyle(document.documentElement).getPropertyValue('--peek-gap'))   || 60,
        scale: [1,
                parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--side-scale-1')) || .78,
                parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--side-scale-2')) || .62,
                parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--side-scale-3')) || .50],
      };

      const N = IMAGES.length;
      const mod = (n, m) => ((n % m) + m) % m;
      const circDelta = (i, c) => { let d = i - c; return mod(d + N/2, N) - N/2; };

      // Random start each load
      let current = Math.floor(Math.random() * N);
      const cards = [];

      function createItem(src, i){
        const item = document.createElement('figure');
        item.className = 'item'; item.dataset.i = i;

        const card = document.createElement('div');
        card.className = 'card';

        const img = document.createElement('img');
        img.alt = `image ${i+1}`;
        img.loading = 'lazy';
        img.decoding = 'async';
        img.src = encodeURI(src);

        card.appendChild(img);
        item.appendChild(card);

        // click a side card to focus it
        item.addEventListener('click', () => goTo(i));

        track.appendChild(item);
        cards.push(item);
      }

      // Position items (supports fractional during drag)
      function render(){
        const { baseShift, peekGap, scale } = CTRL;

        cards.forEach((item, i) => {
          const d  = circDelta(i, current);
          const ad = Math.abs(d);
          let s = 1, x = 0, rY = 0, z = 0, cls = '';

          if (ad < 0.5){
            s = 1; x = 0; rY = 0; z = 0; cls = '';
          } else if (ad < 1.5){
            s = scale[1]; x = Math.sign(d) * (baseShift + peekGap * 0.0); rY = -Math.sign(d) * 12; z = -80; cls = 'side';
          } else if (ad < 2.5){
            s = scale[2]; x = Math.sign(d) * (baseShift*2 + peekGap * 0.5); rY = -Math.sign(d) * 16; z = -160; cls = 'far';
          } else {
            s = scale[3]; x = Math.sign(d) * (baseShift*2.7 + (ad-2)*90); rY = -Math.sign(d) * 18; z = -260; cls = 'hidden';
          }

          item.className = `item ${cls}`.trim();
          // ✅ Baseline is top:50%/left:50% with translate(-50%,-50%); only offset horizontally by x
          item.style.transform =
            `translate3d(${x}px, 0px, ${z}px) translate(-50%, -50%) rotateY(${rY}deg) scale(${s})`;
        });
      }

      function goTo(i){
        const target = mod(i, N);
        const d = circDelta(target, current);
        current = Math.round(current + d);
        current = mod(current, N);
        render();
      }
      const next = () => { current = mod(Math.round(current) + 1, N); render(); };
      const prev = () => { current = mod(Math.round(current) - 1, N); render(); };

      // Buttons / Keys / Wheel
      nextBtn.addEventListener('click', (e) => { e.stopPropagation(); next(); });
      prevBtn.addEventListener('click', (e) => { e.stopPropagation(); prev(); });

      window.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight') next();
        if (e.key === 'ArrowLeft')  prev();
      });

      let wheelLock = false;
      stageEl.addEventListener('wheel', (e) => {
        if (wheelLock) return;
        wheelLock = true; setTimeout(()=>wheelLock=false, 160);
        const delta = Math.abs(e.deltaX) > Math.abs(e.deltaY) ? e.deltaX : e.deltaY;
        if (delta > 0) next(); else if (delta < 0) prev();
      }, { passive:true });

      // Drag / swipe (desktop trackpads / mice)
      (function dragNav(){
        let down=false, sx=0, moved=0, start=0, pid=null;
        const onDown = (e) => {
          if (e.target.closest('.nav-btn')) return; // don't hijack arrow clicks
          down=true; sx=e.clientX; moved=0; start=current; pid=e.pointerId;
          stageEl.setPointerCapture && stageEl.setPointerCapture(pid);
          if (e.cancelable) e.preventDefault();
        };
        const onMove = (e) => {
          if (!down || (pid!=null && e.pointerId!==pid)) return;
          if (e.cancelable) e.preventDefault();
          moved = e.clientX - sx;
          const shift = moved / (CTRL.baseShift * 1.25);
          current = (start - shift + N) % N; // fractional circular
          render();
        };
        const onUp = () => {
          if (!down) return; down=false;
          current = ((Math.round(current) % N) + N) % N;
          render();
        };
        stageEl.addEventListener('pointerdown', onDown, {passive:false});
        stageEl.addEventListener('pointermove', onMove, {passive:false});
        stageEl.addEventListener('pointerup', onUp, {passive:false});
        stageEl.addEventListener('pointercancel', onUp, {passive:false});
        stageEl.addEventListener('mouseleave', onUp, {passive:false});
      })();

      // Build + initial render
      IMAGES.forEach((src, i) => createItem(src, i));

      const ro = new ResizeObserver(render);
      ro.observe(stageEl);
      window.addEventListener('resize', render);

      render();
    }
  </script>
</body>
</html>
