<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>making of the sausage</title>
<meta name="description" content="A clean, coverflow-style gallery: one image centered, neighbors peeking left/right." />
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='86'>◧</text></svg>">

<style>
  :root{
    --bg: #fff;
    --fg: #111;
    --muted: #b5b5b5;
    --accent: #0a84ff;

    --peek-gap: 60px;   /* horizontal gap between items */
    --base-shift: 380px;/* how far each neighbor sits from center */
    --center-max-w: 80vw;
    --center-max-h: 72vh;
    --side-scale-1: .78;/* scale for immediate neighbors */
    --side-scale-2: .62;/* next neighbors */
    --side-scale-3: .50;/* further neighbors */
  }

  * { box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    margin: 0; background: var(--bg); color: var(--fg);
    font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, sans-serif;
  }

  .wrap {
    position: fixed; inset: 0; display: grid; grid-template-rows: auto 1fr auto;
  }

  header { padding: 14px 18px; color: #777; letter-spacing: .25px; }

  /* Stage with perspective for subtle depth */
  .stage {
    position: relative;
    overflow: hidden; /* hide edges during transitions */
    perspective: 1600px;
  }

  /* Track holds all items centered */
  .track {
    position: absolute; inset: 0;
    transform-style: preserve-3d;
    will-change: transform;
  }

  /* Each gallery item is absolutely positioned and transformed by JS */
  .item {
    position: absolute; top: 50%; left: 50%;
    transform-origin: center center;
    transition: transform .35s cubic-bezier(.2,.6,0,1), opacity .35s ease;
    user-select: none;
  }

  /* The card that constrains the image size */
  .card {
    display: grid; place-items: center;
    background: #fff;
    border: 1px solid #eee;
    border-radius: 10px;
    box-shadow: 0 15px 40px rgba(0,0,0,.08);
    overflow: hidden;
    max-width: var(--center-max-w);
    max-height: var(--center-max-h);
  }
  .card img {
    display: block; width: 100%; height: 100%;
    object-fit: contain; background: #fff;
  }

  .item.side { opacity: .75; filter: saturate(.9); }
  .item.far  { opacity: .45; filter: saturate(.8) blur(.2px); }
  .item.hidden { opacity: 0; pointer-events: none; }

  footer {
    display: flex; align-items: center; justify-content: center;
    gap: 10px; padding: 10px 16px 18px;
  }
  .btn {
    appearance: none; border: 1px solid #e6e6e6; background: #fff; color: #111;
    padding: 8px 12px; border-radius: 10px; cursor: pointer; font: inherit;
    transition: border-color .2s ease, transform .08s ease;
  }
  .btn:hover { border-color: #d0d0d0; }
  .btn:active { transform: translateY(1px); }
  .index {
    color: #7d7d7d; min-width: 80px; text-align: center; font-variant-numeric: tabular-nums;
  }

  .dots { display: flex; gap: 6px; align-items: center; margin-left: 12px; flex-wrap: wrap; max-width: 60vw; }
  .dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: #dedede; transition: transform .2s ease, background .2s ease;
  }
  .dot.active { background: var(--accent); transform: scale(1.25); }

  @media (max-width: 900px){
    :root{
      --base-shift: 280px;
      --peek-gap: 40px;
      --center-max-h: 64vh;
    }
    footer { padding-bottom: 14px; }
  }
</style>
</head>

<body>
  <div class="wrap">
    <header>gallery</header>

    <main class="stage" id="stage">
      <div class="track" id="track"></div>
    </main>

    <footer>
      <button class="btn" id="prev" aria-label="Previous (←)">← Prev</button>
      <div class="index" id="idx">1 / 1</div>
      <button class="btn" id="next" aria-label="Next (→)">Next →</button>
      <div class="dots" id="dots" aria-hidden="true"></div>
    </footer>
  </div>

  <script>
    /* Your images (spaces supported) */
    const IMAGES = [
      "images/process/ADT vision.png",
      "images/process/Concentric.png",
      "images/process/criteriaforintake.png",
      "images/process/CRM.png",
      "images/process/cryptotransfer.png",
      "images/process/curriculum.png",
      "images/process/Datapoints.png",
      "images/process/GNC learning.png",
      "images/process/humaneval.png",
      "images/process/knowledge sharing.png",
      "images/process/Laddering Data.jpg",
      "images/process/manual.png",
      "images/process/medium is msg.png",
      "images/process/Name Parameters.png",
      "images/process/naming systems.png",
      "images/process/ORG.png",
      "images/process/ourresources.png",
      "images/process/opp.png",
      "images/process/Persona.jpg",
      "images/process/playground UI.png",
      "images/process/Product Partnerships Data Knowledge.png",
      "images/process/Reach.png",
      "images/process/Reachout if.png",
      "images/process/Rules.png",
      "images/process/scales of a problem.png",
      "images/process/timeline.png",
      "images/process/types of slides.png",
      "images/process/vendorgrid.png",
      "images/process/whatwedonose.png",
      "images/process/why-how.png",
      "images/process/XCapit.png"
    ];

    const stageEl = document.getElementById('stage');
    const track   = document.getElementById('track');
    const idxEl   = document.getElementById('idx');
    const dotsEl  = document.getElementById('dots');

    const CTRL = {
      baseShift: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--base-shift')) || 380,
      peekGap:   parseInt(getComputedStyle(document.documentElement).getPropertyValue('--peek-gap'))   || 60,
      scale: [1,
              parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--side-scale-1')) || .78,
              parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--side-scale-2')) || .62,
              parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--side-scale-3')) || .50],
    };

    let current = 0; // centered index
    const cards = [];

    function createItem(src, i){
      const item = document.createElement('figure');
      item.className = 'item';
      item.dataset.i = i;

      const card = document.createElement('div');
      card.className = 'card';

      const img = document.createElement('img');
      img.alt = `image ${i+1}`;
      img.loading = 'lazy';
      img.decoding = 'async';
      img.src = encodeURI(src);
      card.appendChild(img);
      item.appendChild(card);

      // click a side card to focus it
      item.addEventListener('click', () => {
        const idx = +item.dataset.i;
        if (idx !== current) goTo(idx);
      });

      track.appendChild(item);
      cards.push(item);
    }

    // Position items based on current index
    function render(){
      const { baseShift, peekGap, scale } = CTRL;

      cards.forEach((item, i) => {
        const d  = i - current;   // distance from center in items
        const ad = Math.abs(d);   // absolute distance
        let s = 1, x = 0, rY = 0, z = 0, cls = '';

        if (ad === 0){
          s = 1; x = 0; rY = 0; z = 0; cls = '';
        } else if (ad === 1){
          s = scale[1]; x = Math.sign(d) * (baseShift + peekGap * 0.0); rY = -Math.sign(d) * 12; z = -80; cls = 'side';
        } else if (ad === 2){
          s = scale[2]; x = Math.sign(d) * (baseShift*2 + peekGap * 0.5); rY = -Math.sign(d) * 16; z = -160; cls = 'far';
        } else {
          s = scale[3]; x = Math.sign(d) * (baseShift*2.7 + (ad-2)*90); rY = -Math.sign(d) * 18; z = -260; cls = 'hidden';
        }

        item.className = `item ${cls}`.trim();
        // ✅ Center is already at top:50%/left:50% with translate(-50%,-50%)
        //    Only offset horizontally by x; no extra centering math.
        item.style.transform =
          `translate3d(${x}px, 0px, ${z}px) translate(-50%, -50%) rotateY(${rY}deg) scale(${s})`;
      });

      idxEl.textContent = `${current+1} / ${cards.length}`;
      updateDots();
    }

    function goTo(i){
      current = Math.max(0, Math.min(cards.length - 1, i));
      render();
    }

    function next(){ if (current < cards.length - 1) goTo(current + 1); }
    function prev(){ if (current > 0) goTo(current - 1); }

    // Dots
    function makeDots(){
      dotsEl.innerHTML = '';
      IMAGES.forEach((_, i) => {
        const d = document.createElement('div');
        d.className = 'dot';
        d.addEventListener('click', () => goTo(i));
        dotsEl.appendChild(d);
      });
    }
    function updateDots(){
      const ds = dotsEl.querySelectorAll('.dot');
      ds.forEach((d, i) => d.classList.toggle('active', i === current));
    }

    // Input: buttons, keys, wheel, drag/swipe
    document.getElementById('next').addEventListener('click', next);
    document.getElementById('prev').addEventListener('click', prev);

    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') next();
      if (e.key === 'ArrowLeft')  prev();
    });

    // Wheel: horizontal nav (bind to STAGE so page scroll doesn’t fight)
    let wheelLock = false;
    stageEl.addEventListener('wheel', (e) => {
      if (wheelLock) return;
      wheelLock = true;
      setTimeout(()=>wheelLock=false, 180);
      const delta = Math.abs(e.deltaX) > Math.abs(e.deltaY) ? e.deltaX : e.deltaY;
      if (delta > 0) next(); else if (delta < 0) prev();
    }, { passive: true });

    // Drag / swipe (bind to STAGE)
    (function dragNav(){
      let down = false, sx = 0, moved = 0;
      stageEl.addEventListener('pointerdown', (e) => { down = true; sx = e.clientX; moved = 0; });
      stageEl.addEventListener('pointermove', (e) => {
        if (!down) return;
        moved = e.clientX - sx;
        // live-peek while dragging (subtle)
        const shift = moved / (CTRL.baseShift * 1.25);
        const tempIndex = current - shift;
        const prevCurrent = current;
        current = Math.min(cards.length-1, Math.max(0, tempIndex));
        render();
        current = prevCurrent;
      });
      const release = () => {
        if (!down) return; down = false;
        const threshold = 60;
        if (moved < -threshold) next();
        else if (moved > threshold) prev();
        else render(); // snap back
      };
      stageEl.addEventListener('pointerup', release);
      stageEl.addEventListener('pointercancel', () => { down = false; render(); });
      stageEl.addEventListener('mouseleave', () => { down = false; });
    })();

    // Build
    IMAGES.forEach((src, i) => createItem(src, i));
    makeDots();

    // Re-render on resize of stage
    const ro = new ResizeObserver(render);
    ro.observe(stageEl);
    window.addEventListener('resize', render);

    render();
  </script>
</body>
</html>
